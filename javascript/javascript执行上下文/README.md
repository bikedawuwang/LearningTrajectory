# JavaScript中的执行上下文

## 什么是执行上下文？

执行上下文是执行JavaScript代码环境的抽象概念，每当JavaScript运行时，它都是在执行上下文中运行。

## 执行上下文的类型

JavaScript中存在三种执行上下文

1. 全局执行上下文
2. 函数执行上下文
3. Eval执行上下文

### 1. 全局执行上下文

全局执行上下文在执行时只会做两件事， 1. 创建一个window对象 2. 设置this值等于这个对象。

### 2. 函数执行上下文

每当一个函数被调用时，都会为该函数创建一个新的上下文，每个函数都有自己的上下文，不过是在被调用时创建的。每当新的函数执行上下文被创建时，它会按照定义的顺序执行一系列步骤

### 3. Eval执行上下文

执行Eval代码也会有它属于自己的上下文，由于不经常使用，所以就不多做赘述


## 执行栈

执行栈，也就是其他语言中的调用栈，是一种拥有LIFO（后进先出）数据结构的栈，用来存储函数执行时所创建的上下文

当JavaScript引擎第一次遇到你的脚本时，它会创建一个全局的执行上下文，并且压入当前执行栈。

JavaScript引擎会执行那些位于执行栈顶的上下文，当执行完毕后，执行上下文从栈中弹出。


##  怎么创建执行上下文

创建执行上下文有两个阶段， 1）创建阶段  2) 执行阶段

### The Creation Phase

在JavaScript代码执行前，执行上下文会经理创建阶段，在创建阶段会发生三件事：

- 1. this值的决定。
- 2. 创建词法环境组件
- 3. 创建变量组件

## This 的绑定

在全局执行上下文中， this 的值指向全局对象。

在函数执行上下文中，this的值取决于该函数是如何被调用的，如果是呗引用对象调用， 那么this会被设置成那个对象，否则this的值被设置为全局对象（严格模式下为 undefined）

## 词法环境

词法环境是一种持有 标识符-变量映射 的结构。

在词法变量中有两个组件： 1）环境记录器  2）一个外部环境的引用

词法环境的两种类型：

- 全局环境（全局执行上下文） 是没有外部环境引用的词法环境。全局环境的外部环境引用是null。 它拥有内建的 Object/Array 等、在环境记录器内的原型函数





